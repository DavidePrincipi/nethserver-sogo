<Location /SOGo>
    ProxyPass http://127.0.0.1:20000/SOGo retry=0
    ProxyPassReverse http://127.0.0.1:20000/SOGo
    SetEnv proxy-nokeepalive 1
</Location>
{

    if ((($sogod{'Dav'} || '') eq 'enabled') && (($webtop{'Dav'} || 'disabled') eq 'disabled')){
       $OUT.= "ProxyPass /dav http://127.0.0.1:20000/SOGo/dav\n";
       $OUT.= "ProxyPass /cal http://127.0.0.1:20000/SOGo/dav\n";
       $OUT.= "ProxyPass /card http://127.0.0.1:20000/SOGo/dav\n";
       $OUT.= "ProxyPass /.well-known/caldav http://127.0.0.1:20000/SOGo/dav\n";
       $OUT.= "ProxyPass /.well-known/carddav http://127.0.0.1:20000/SOGo/dav\n";
    }
}

ProxyRequests Off
ProxyPreserveHost On

SetEnvIf Host (.*) REQUEST_HOST=$1
<Proxy http://127.0.0.1:20000/SOGo>
   RequestHeader set "x-webobjects-server-port" "443"
   RequestHeader set "x-webobjects-server-name" "%\{REQUEST_HOST\}e"
   RequestHeader set "x-webobjects-server-url" "https://%\{REQUEST_HOST\}e/SOGo"
   RequestHeader set "x-webobjects-server-protocol" "HTTP/1.0"
   AddDefaultCharset UTF-8
   Require all granted
</Proxy>

Alias /SOGo.woa/WebServerResources/ /usr/lib64/GNUstep/SOGo/WebServerResources/
Alias /SOGo/WebServerResources/ /usr/lib64/GNUstep/SOGo/WebServerResources/

<Directory /usr/lib64/GNUstep/SOGo/>
    AllowOverride None
    Require all granted
    <IfModule expires_module>
      ExpiresActive On
      ExpiresDefault "access plus 1 year"
    </IfModule>
</Directory>

{
    if ((($sogod{'ActiveSync'} || '') eq 'enabled') && (($webtop{'ActiveSync'} || 'disabled') eq 'disabled')){
        $OUT .= <<EOF
<Location /Microsoft-Server-ActiveSync>
    ProxyPass http://127.0.0.1:20000/SOGo/Microsoft-Server-ActiveSync retry=60 connectiontimeout=5 timeout=360
</Location>

EOF
    }
}